<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CUFP</title>

  <link href="http://fonts.googleapis.com/css?family=Lato:400,700|Montserrat:700" rel="stylesheet" type="text/css"/>

  <link rel="stylesheet" href="../css0/foundation-icons/foundation-icons.css"/>
  <link rel="stylesheet" href="../css0/fairhead-webicons/webicons.css"/>
  <link rel="stylesheet" href="../css0/flaticon-feather-pen/flaticon.css"/>
  <link rel="stylesheet" href="../css0/cufp.css"/>
  <script src="../js0/modernizr.js"></script>

</head>

<body class="event">


<nav class="top-bar" data-topbar="data-topbar">
  <ul class="title-area">
    <li class="name">
      <h1><a href="/"><i class="fi-home"></i></a></h1>
    </li>
    <li class="toggle-topbar menu-icon"><a href="#"></a></li>
  </ul>

  <section class="top-bar-section">

    <ul class="left">
      <li><a href="/blog/"><i class="fi-rss"></i> Blog</a></li>
      <li><a href="/videos/"><i class="fi-video size-72"></i> Videos</a></li>
    </ul>

  </section>
</nav>


<div class="row"><div class="small-12 columns"><h1><i class="fi-microphone"></i> Functional Programming at Facebook</h1><div class="speakers"><ul><li><span class="person">Christopher Piro</span> <span class="affiliation">Facebook</span></li><li><span class="person">Eugene Letuchy</span> <span class="affiliation">Facebook</span></li></ul></div><div class="time">September 04, 2009 2:00 - 2:30 PM</div><div class="slides"><i class="fi-page"></i> <a href="/archive/2009/slides/PiroLetuchy.pdf">Slides</a></div>

<h2 id="Abstract">Abstract</h2><p>We use Erlang, ML, and Haskell for a few small projects but (as I&#39;m sure you guessed) we&#39;d like to focus on the lessons we&#39;ve learned using Erlang for building Facebook Chat. The channel servers are at the heart of our Chat infrastructure; they receive messages from our web servers and queue them for HTTP delivery. Presence information, the knowledge of who is currently using Chat, is aggregated and shipped to a separate service. The service has been operational since our launch about a year ago and we continue to develop and improve it frequently. We&#39;re also developing an XMPP interface to Facebook Chat based on the ejabberd project. A lot of functionality has been added to interact with the many moving parts of our infrastructure.</p>
<p>Erlang has been the right tool for the job. It&#39;s well-known that Erlang is a good choice for communications applications and real-time chat in particular, and we&#39;d like to mention that Erlang&#39;s strong support for concurrency, distribution, hot code loading, and online debugging have been indispensable, and that it&#39;s those same weaknesses that lead us away from C++ when first designing the service. However, we&#39;d like to focus on the factors inside and outside Facebook that enabled us to choose Erlang in the first place. Most importantly, we needed good support for language-independent RPC. Fortunately we rely heavily on Thrift for all our services. Both the channel and Jabber servers need to speak to programs written in PHP and C++, and having infrastructure and engineers comfortable debugging it already in place when we began was invaluable. Our service management tools as well are language-independent; all our services regardless of language are controlled using the same interface. Facebook and the Thrift project are also fortunate to have an active community. The original Thrift binding for Erlang was implemented in-house but substantial portions were reimplemented by outside contributors. As well we&#39;ve leveraged existing open source products including ejabberd and Bob Ippolito&#39;s Mochiweb framework.</p>
<p>The other half of our story consists of the barriers presented and risks taken in choosing Erlang. I mentioned above that much of Facebook&#39;s infrastructure is language-agnostic, but our build and deploy systems unfortunately are not. Many of our internal tools weren&#39;t written with Erlang or (in particular) hot code reloading in mind, so we needed to write many one-offs to support all the runtime goodness that Erlang affords us. Facebook runs many services, most of which are in C++, Python, or Java, and only two in Erlang, so in some respects we&#39;ve needed to work harder to integrate. We at Facebook also tend to work in large codebases and share the responsibility of bug fixing. Unfortunately, our Erlang projects live outside of our main repository, and the extra learning necessary to develop or just fix bugs in Erlang tends to keep us isolated from the pool of talent in our department. Unsurprisingly, the job of fixing Chat bugs falls to one of a very small group, whereas bugs in our PHP code have a small army of PHP generalists waiting to squash them. However Erlang has such a steep learning curve only because most undergraduate programs don&#39;t stress functional programming, and Facebook in particular doesn&#39;t expose most engineers to functional programming, or even information about the strengths and weaknesses of FP versus PHP, C++, and Python. In particular we&#39;d like to touch on the prevalence of object-oriented programming in education and in practice, and the tendency of engineers (even engineers with FP experience) to guide their design by OOP principles even when they don&#39;t fit. The recurring theme is &quot;the right tool for the job&quot; — actor-based, functional, imperative, and object-oriented programming are all valuable tools for modeling particular problems, but the most important lessons in our experience are how to lower the barriers to choosing the right tool, and how to arm engineers with the knowledge they need to make an appropriate choice.</p>
<div class="flex-video"><iframe src="http://player.vimeo.com/video/6699769?title=0&byline=0&portrait=0" width="420" height="315" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe></div><div id="disqus_thread"></div><script type="text/javascript">
  var disqus_shortname = 'cufp';

  (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
   })();
</script></div></div>


<footer>
<div class="row" data-equalizer="data-equalizer">

  <div class="medium-3 columns text-center" data-equalizer-watch="data-equalizer-watch">
    <h3>CUFP</h3>
    <p><i>Functional Programming as a means, not an end.</i></p>
    <p>Co-located with <a href="http://icfpconference.org"><b>ICFP</b></a>.</p>
  </div>

  <div class="medium-2 columns social" data-equalizer-watch="data-equalizer-watch">
    <ul class="small-block-grid-4 medium-block-grid-2">
      <li>
        <a href="https://twitter.com/cufpconference">
          <i class="fi-social-twitter"></i>
        </a>
      </li>
      <li>
        <a href="/blog/">
          <i class="fi-rss"></i>
        </a>
      </li>
      <li>
        <a href="https://github.com/cufp">
          <i class="fi-social-github"></i>
        </a>
      </li>
      <li>
        <a href="/videos/">
          <i class="fi-video"></i>
        </a>
      </li>
    </ul>
  </div>

  <div class="medium-3 columns text-center" data-equalizer-watch="data-equalizer-watch">
    <ul>
      <li><a href="/about.html">About</a></li>
      <li><a href="/bylaws.html">Bylaws</a></li>
      <li><a href="/steering-committee.html">Steering Committee</a></li>
    </ul>
    <ul>
      <li><a href="/license.html">Licenses</a></li>
      <li><a href="http://github.com/cufp/cufp.org/issues">Website Issues</a></li>
    </ul>
  </div>
</div>
</footer>

<footer class="copyright">
<div class="row">
  <div class="small-12 columns">
      <p>© Copyright 2004 – 2016
 Commercial Users of
      Functional Programming. Details
      in <a href="/license.html">Licenses</a>.</p>
  </div>
</div>
</footer>


<script src="../js0/jquery.min.js"></script>
<script src="../js0/fastclick.js"></script>
<script src="../js0/foundation.js"></script>
<script src="../js0/foundation.abide.js"></script>
<script src="../js0/foundation.accordion.js"></script>
<script src="../js0/foundation.alert.js"></script>
<script src="../js0/foundation.clearing.js"></script>
<script src="../js0/foundation.dropdown.js"></script>
<script src="../js0/foundation.equalizer.js"></script>
<script src="../js0/foundation.interchange.js"></script>
<script src="../js0/foundation.joyride.js"></script>
<script src="../js0/foundation.magellan.js"></script>
<script src="../js0/foundation.offcanvas.js"></script>
<script src="../js0/foundation.orbit.js"></script>
<script src="../js0/foundation.reveal.js"></script>
<script src="../js0/foundation.slider.js"></script>
<script src="../js0/foundation.tab.js"></script>
<script src="../js0/foundation.tooltip.js"></script>
<script src="../js0/foundation.topbar.js"></script>
<script>
  $(document).foundation();
</script>


<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>




<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(["_setAccount", "UA-12990950-1"]);
  _gaq.push(["_setVar", "anonymous user"]);
  _gaq.push(['_setCustomVar', 1, "User roles", "anonymous user", 1]);
  _gaq.push(["_trackPageview"]);

  (function() {
     var ga = document.createElement("script");
     ga.type = "text/javascript";
     ga.async = true;
     ga.src =
       ("https:" == document.location.protocol ? "https://ssl" : "http://www") +
       ".google-analytics.com/ga.js";
     var s = document.getElementsByTagName("script")[0];
     s.parentNode.insertBefore(ga, s);
   })();
</script>

</body>
</html>
