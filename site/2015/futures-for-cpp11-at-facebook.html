<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CUFP</title>

  <link href="http://fonts.googleapis.com/css?family=Lato:400,700|Montserrat:700" rel="stylesheet" type="text/css"/>

  <link rel="stylesheet" href="../css0/foundation-icons/foundation-icons.css"/>
  <link rel="stylesheet" href="../css0/fairhead-webicons/webicons.css"/>
  <link rel="stylesheet" href="../css0/flaticon-feather-pen/flaticon.css"/>
  <link rel="stylesheet" href="../css0/cufp.css"/>
  <script src="../js0/modernizr.js"></script>

</head>

<body class="event">


<nav class="top-bar" data-topbar="data-topbar">
  <ul class="title-area">
    <li class="name">
      <h1><a href="/"><i class="fi-home"></i></a></h1>
    </li>
    <li class="toggle-topbar menu-icon"><a href="#"></a></li>
  </ul>

  <section class="top-bar-section">

    <ul class="left">
      <li><a href="/blog/"><i class="fi-rss"></i> Blog</a></li>
      <li><a href="/videos/"><i class="fi-video size-72"></i> Videos</a></li>
    </ul>

  </section>
</nav>


<div class="row"><div class="small-12 columns"><h1><i class="fi-microphone"></i> Futures for C++11 at Facebook</h1><div class="speakers"><ul><li><span class="person">Hans Fugal</span> <span class="affiliation">Facebook</span></li></ul></div><div class="time">September 05, 2015 3:35 - 4:00 PM</div>

<h2 id="Abstract">Abstract</h2>

<p>The Future (Promise) monad expresses asynchronous computation, e.g. &quot;fetch this data, then post-process it, then reduce it&quot;. It is a popular pattern in various (semi)functional languages, such as Scala and JavaScript.</p>
<p>We at Facebook saw the utility of this pattern and wished to apply it in our C++ codebase. C++11 has std::future but it does not allow chaining; it is not monadic. So we wrote our own implementation, modeled after Twitter&#39;s futures as used in Finagle [1] and taking boost::future [2] and C++ standard proposal N3428 [3] into consideration. We have open sourced it as part of Folly [4].</p>
<p>We will talk about implementing this pattern in C++ and in the Facebook environment. Various details of C++ have complicating implications that are not apparent at first blush when considering implementing this pattern. For example: polymorphism requirements, heap object lifetime, move semantics, and underpowered templates. Facebook developers demand extreme performance, clean and expressive syntax that fully leverages new C++11 features, and full control over execution context and flow between threads (with sensible defaults). We also strived to make it as frictionless as possible to migrate legacy synchronous code to be asynchronous using Futures, with an eye toward parallelizing the embarrassingly parallel sections of that code.</p>
<p>With the flurry of new functional features in C++11, C++ developers are starting to embrace functional idioms, but are also slow to let go of imperative habits. As we have helped C++ developers utilize this pattern we have seen recurrent pitfalls, compromises, and a-ha moments.</p>
<p>We will speak about the Folly Futures implementation, what challenges and tradeoffs we found due to C++ and Facebook developer culture, and how the pattern has been received and how it has paid off for us.</p>
<p>[1]: <a href="https://twitter.github.io/finagle/guide/Futures.html">https://twitter.github.io/finagle/guide/Futures.html</a><br/>[2]: <a href="http://www.boost.org/doc/libs/1_53_0/doc/html/thread/synchronization.html#thread.synchronization.futures">http://www.boost.org/doc/libs/1_53_0/doc/html/thread/synchronization.html#thread.synchronization.futures</a><br/>[3]: <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3428.pdf">http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3428.pdf</a><br/>[4]: <a href="https://github.com/facebook/folly/blob/master/folly/futures/README.md">https://github.com/facebook/folly/blob/master/folly/futures/README.md</a><br/>[5]: <a href="https://code.facebook.com/posts/1661982097368498">https://code.facebook.com/posts/1661982097368498</a></p>
<h2 id="HansFugal">Hans Fugal</h2>
<div class="row">

<div class="medium-4 columns">
<img alt="Hans Fugal" src="img/hans-fugal.jpg"/>
</div>

<div class="medium-8 columns"><p>Hans Fugal is a software engineer at Facebook. He has worked on memcache and mcrouter, datacenter QoS, and now asynchronous APIs. Before Facebook he was a computer music PhD student and VOIP consultant. He enjoys exploring languages, trying to make C++ pretend to be like those languages, and hopes to some day really grok functional programming.</p>
</div></div><div class="flex-video"><iframe src="http://www.youtube.com/embed/lL_Wkwvqb9o?controls=2&showinfo=0&theme=light&autohide=1" width="420" height="315" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe></div><div id="disqus_thread"></div><script type="text/javascript">
  var disqus_shortname = 'cufp';

  (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
   })();
</script></div></div>


<footer>
<div class="row" data-equalizer="data-equalizer">

  <div class="medium-3 columns text-center" data-equalizer-watch="data-equalizer-watch">
    <h3>CUFP</h3>
    <p><i>Functional Programming as a means, not an end.</i></p>
    <p>Co-located with <a href="http://icfpconference.org"><b>ICFP</b></a>.</p>
  </div>

  <div class="medium-2 columns social" data-equalizer-watch="data-equalizer-watch">
    <ul class="small-block-grid-4 medium-block-grid-2">
      <li>
        <a href="https://twitter.com/cufpconference">
          <i class="fi-social-twitter"></i>
        </a>
      </li>
      <li>
        <a href="/blog/">
          <i class="fi-rss"></i>
        </a>
      </li>
      <li>
        <a href="https://github.com/cufp">
          <i class="fi-social-github"></i>
        </a>
      </li>
      <li>
        <a href="/videos/">
          <i class="fi-video"></i>
        </a>
      </li>
    </ul>
  </div>

  <div class="medium-3 columns text-center" data-equalizer-watch="data-equalizer-watch">
    <ul>
      <li><a href="/about.html">About</a></li>
      <li><a href="/bylaws.html">Bylaws</a></li>
      <li><a href="/steering-committee.html">Steering Committee</a></li>
    </ul>
    <ul>
      <li><a href="/license.html">Licenses</a></li>
      <li><a href="http://github.com/cufp/cufp.org/issues">Website Issues</a></li>
    </ul>
  </div>
</div>
</footer>

<footer class="copyright">
<div class="row">
  <div class="small-12 columns">
      <p>© Copyright 2004 – 2016
 Commercial Users of
      Functional Programming. Details
      in <a href="/license.html">Licenses</a>.</p>
  </div>
</div>
</footer>


<script src="../js0/jquery.min.js"></script>
<script src="../js0/fastclick.js"></script>
<script src="../js0/foundation.js"></script>
<script src="../js0/foundation.abide.js"></script>
<script src="../js0/foundation.accordion.js"></script>
<script src="../js0/foundation.alert.js"></script>
<script src="../js0/foundation.clearing.js"></script>
<script src="../js0/foundation.dropdown.js"></script>
<script src="../js0/foundation.equalizer.js"></script>
<script src="../js0/foundation.interchange.js"></script>
<script src="../js0/foundation.joyride.js"></script>
<script src="../js0/foundation.magellan.js"></script>
<script src="../js0/foundation.offcanvas.js"></script>
<script src="../js0/foundation.orbit.js"></script>
<script src="../js0/foundation.reveal.js"></script>
<script src="../js0/foundation.slider.js"></script>
<script src="../js0/foundation.tab.js"></script>
<script src="../js0/foundation.tooltip.js"></script>
<script src="../js0/foundation.topbar.js"></script>
<script>
  $(document).foundation();
</script>


<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>




<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(["_setAccount", "UA-12990950-1"]);
  _gaq.push(["_setVar", "anonymous user"]);
  _gaq.push(['_setCustomVar', 1, "User roles", "anonymous user", 1]);
  _gaq.push(["_trackPageview"]);

  (function() {
     var ga = document.createElement("script");
     ga.type = "text/javascript";
     ga.async = true;
     ga.src =
       ("https:" == document.location.protocol ? "https://ssl" : "http://www") +
       ".google-analytics.com/ga.js";
     var s = document.getElementsByTagName("script")[0];
     s.parentNode.insertBefore(ga, s);
   })();
</script>

</body>
</html>
